<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ - Ø³ÙˆÙ‚ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <style>
        .register-bg {
            background: linear-gradient(135deg, 
                rgba(16, 185, 129, 0.9) 0%, 
                rgba(5, 150, 105, 0.9) 100%),
                url('../assets/auth-bg/car-register.jpg');
            background-size: cover;
            background-position: center;
        }
        
        .step-indicator {
            position: relative;
            z-index: 1;
        }
        
        .step-indicator::before {
            content: '';
            position: absolute;
            top: 24px;
            right: 50%;
            width: 100%;
            height: 2px;
            background-color: #e5e7eb;
            z-index: -1;
        }
        
        .step-indicator:first-child::before {
            display: none;
        }
        
        .step-indicator.active::before {
            background-color: #10b981;
        }
        
        .password-requirements {
            margin-top: 0.5rem;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 0.5rem;
            border: 1px solid #e2e8f0;
        }
        
        .requirement-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            color: #64748b;
            font-size: 0.875rem;
        }
        
        .requirement-item.valid {
            color: #10b981;
        }
        
        .requirement-item.invalid {
            color: #ef4444;
        }
        
        .requirement-item i {
            margin-left: 0.5rem;
            font-size: 0.75rem;
        }
        
        .country-code-select {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #6b7280;
            font-size: 16px;
            padding-right: 8px;
            border-right: 1px solid #e5e7eb;
        }
        
        .verification-inputs {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }
        
        .verification-input {
            width: 3.5rem;
            height: 3.5rem;
            text-align: center;
            font-size: 1.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.75rem;
            background: white;
            transition: all 0.3s ease;
        }
        
        .verification-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            outline: none;
        }
        
        .verification-input.filled {
            border-color: #10b981;
            background: #f0fdf4;
        }
        
        .countdown-timer {
            font-family: monospace;
            font-weight: bold;
            color: #3b82f6;
        }
        
        .user-type-card {
            border: 2px solid #e5e7eb;
            border-radius: 1rem;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .user-type-card:hover {
            border-color: #3b82f6;
            transform: translateY(-4px);
        }
        
        .user-type-card.selected {
            border-color: #10b981;
            background: #f0fdf4;
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.1);
        }
    </style>
</head>
<body class="register-bg min-h-screen flex items-center justify-center p-4">
    
    <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
    <div class="auth-card rounded-2xl w-full max-w-2xl animate__animated animate__fadeInUp">
        <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø®Ø·ÙˆØ§Øª -->
        <div class="p-6 border-b">
            <div class="flex justify-between">
                <div class="step-indicator flex flex-col items-center flex-1">
                    <div class="w-12 h-12 rounded-full bg-green-500 text-white flex items-center justify-center font-bold mb-2">
                        1
                    </div>
                    <span class="font-bold text-green-600">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</span>
                </div>
                
                <div class="step-indicator flex flex-col items-center flex-1">
                    <div class="w-12 h-12 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center font-bold mb-2">
                        2
                    </div>
                    <span class="font-bold text-gray-500">Ø§Ù„ØªØ­Ù‚Ù‚</span>
                </div>
                
                <div class="step-indicator flex flex-col items-center flex-1">
                    <div class="w-12 h-12 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center font-bold mb-2">
                        3
                    </div>
                    <span class="font-bold text-gray-500">Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„</span>
                </div>
            </div>
        </div>
        
        <!-- Ø§Ù„Ø´Ø¹Ø§Ø± -->
        <div class="p-8 text-center">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨Ø§Ù‹ Ø¬Ø¯ÙŠØ¯Ø§Ù‹</h1>
            <p class="text-gray-600">Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø£ÙƒØ¨Ø± Ø³ÙˆÙ‚ Ù„Ù„Ø³ÙŠØ§Ø±Ø§Øª ÙÙŠ Ø§Ù„ÙˆØ·Ù† Ø§Ù„Ø¹Ø±Ø¨ÙŠ</p>
        </div>
        
        <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ø®Ø·ÙˆØ§Øª -->
        <form id="registerForm" class="p-8">
            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© -->
            <div class="step-content active" id="step-1">
                <!-- Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
                <div class="mb-8">
                    <label class="block font-bold mb-4 text-gray-700">Ø£Ù†Ø§</label>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="user-type-card" data-type="buyer">
                            <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-shopping-cart text-blue-600 text-2xl"></i>
                            </div>
                            <div class="font-bold text-gray-800 mb-2">Ù…Ø´ØªØ±ÙŠ</div>
                            <div class="text-gray-600 text-sm">Ø£Ø±ØºØ¨ ÙÙŠ Ø´Ø±Ø§Ø¡ Ø³ÙŠØ§Ø±Ø©</div>
                        </div>
                        
                        <div class="user-type-card" data-type="seller">
                            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-car text-green-600 text-2xl"></i>
                            </div>
                            <div class="font-bold text-gray-800 mb-2">Ø¨Ø§Ø¦Ø¹</div>
                            <div class="text-gray-600 text-sm">Ø£Ø±ØºØ¨ ÙÙŠ Ø¨ÙŠØ¹ Ø³ÙŠØ§Ø±ØªÙŠ</div>
                        </div>
                        
                        <div class="user-type-card" data-type="both">
                            <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-exchange-alt text-purple-600 text-2xl"></i>
                            </div>
                            <div class="font-bold text-gray-800 mb-2">Ø§Ù„Ø§Ø«Ù†ÙŠÙ† Ù…Ø¹Ø§Ù‹</div>
                            <div class="text-gray-600 text-sm">Ø£Ø±ØºØ¨ ÙÙŠ Ø§Ù„Ø¨ÙŠØ¹ ÙˆØ§Ù„Ø´Ø±Ø§Ø¡</div>
                        </div>
                    </div>
                    <input type="hidden" id="userType" name="userType" required>
                </div>
                
                <!-- Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="input-group">
                        <input type="text" 
                               id="fullName"
                               name="fullName"
                               placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„"
                               required
                               class="form-input">
                        <i class="input-icon fas fa-user"></i>
                        <div class="text-red-500 text-sm mt-1 hidden" id="fullNameError"></div>
                    </div>
                    
                    <div class="input-group">
                        <input type="email" 
                               id="registerEmail"
                               name="email"
                               placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"
                               required
                               class="form-input">
                        <i class="input-icon fas fa-envelope"></i>
                        <div class="text-red-500 text-sm mt-1 hidden" id="emailError"></div>
                    </div>
                    
                    <div class="input-group relative">
                        <select class="country-code-select" id="countryCode">
                            <option value="+966">+966</option>
                            <option value="+971">+971</option>
                            <option value="+973">+973</option>
                            <option value="+974">+974</option>
                            <option value="+20">+20</option>
                        </select>
                        <input type="tel" 
                               id="phone"
                               name="phone"
                               placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"
                               required
                               class="form-input pl-24">
                        <i class="input-icon fas fa-phone" style="left: 80px;"></i>
                        <div class="text-red-500 text-sm mt-1 hidden" id="phoneError"></div>
                    </div>
                    
                    <div class="input-group">
                        <input type="text" 
                               id="city"
                               name="city"
                               placeholder="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©"
                               required
                               class="form-input">
                        <i class="input-icon fas fa-map-marker-alt"></i>
                        <div class="text-red-500 text-sm mt-1 hidden" id="cityError"></div>
                    </div>
                </div>
                
                <!-- ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
                <div class="mb-6">
                    <div class="input-group">
                        <input type="password" 
                               id="registerPassword"
                               name="password"
                               placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
                               required
                               minlength="8"
                               class="form-input">
                        <i class="input-icon fas fa-lock"></i>
                        <button type="button" class="password-toggle" id="togglePassword">
                            <i class="fas fa-eye"></i>
                        </button>
                        <div class="text-red-500 text-sm mt-1 hidden" id="passwordError"></div>
                    </div>
                    
                    <!-- Ù…ØªØ·Ù„Ø¨Ø§Øª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
                    <div class="password-requirements">
                        <div class="requirement-item" id="reqLength">
                            <i class="fas fa-circle"></i>
                            <span>8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</span>
                        </div>
                        <div class="requirement-item" id="reqUppercase">
                            <i class="fas fa-circle"></i>
                            <span>Ø­Ø±Ù ÙƒØ¨ÙŠØ± ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</span>
                        </div>
                        <div class="requirement-item" id="reqLowercase">
                            <i class="fas fa-circle"></i>
                            <span>Ø­Ø±Ù ØµØºÙŠØ± ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</span>
                        </div>
                        <div class="requirement-item" id="reqNumber">
                            <i class="fas fa-circle"></i>
                            <span>Ø±Ù‚Ù… ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</span>
                        </div>
                        <div class="requirement-item" id="reqSpecial">
                            <i class="fas fa-circle"></i>
                            <span>Ø±Ù…Ø² Ø®Ø§Øµ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</span>
                        </div>
                    </div>
                </div>
                
                <!-- ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
                <div class="input-group mb-6">
                    <input type="password" 
                           id="confirmPassword"
                           name="confirmPassword"
                           placeholder="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
                           required
                           class="form-input">
                    <i class="input-icon fas fa-lock"></i>
                    <button type="button" class="password-toggle" id="toggleConfirmPassword">
                        <i class="fas fa-eye"></i>
                    </button>
                    <div class="text-red-500 text-sm mt-1 hidden" id="confirmPasswordError"></div>
                </div>
                
                <!-- Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù… -->
                <div class="mb-8">
                    <label class="flex items-start cursor-pointer">
                        <input type="checkbox" 
                               id="terms"
                               name="terms"
                               required
                               class="h-5 w-5 text-blue-600 rounded border-gray-300 mt-1">
                        <span class="mr-3 text-gray-700">
                            Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ 
                            <a href="#" class="text-blue-600 hover:text-blue-800">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a> Ùˆ 
                            <a href="#" class="text-blue-600 hover:text-blue-800">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a>
                        </span>
                    </label>
                    <div class="text-red-500 text-sm mt-1 hidden" id="termsError"></div>
                </div>
                
                <!-- Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ -->
                <div class="flex justify-end">
                    <button type="button" 
                            id="nextStep1"
                            class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-xl font-bold hover:shadow-xl transition">
                        Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-arrow-left ml-3"></i>
                    </button>
                </div>
            </div>
            
            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ù„ØªØ­Ù‚Ù‚ -->
            <div class="step-content hidden" id="step-2">
                <div class="text-center mb-8">
                    <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-mobile-alt text-blue-600 text-3xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡Ø§ØªÙ</h3>
                    <p class="text-gray-600">
                        ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ 
                        <span id="phoneDisplay" class="font-bold"></span>
                    </p>
                </div>
                
                <!-- Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ -->
                <div class="mb-8">
                    <div class="verification-inputs mb-6">
                        <input type="text" maxlength="1" class="verification-input">
                        <input type="text" maxlength="1" class="verification-input">
                        <input type="text" maxlength="1" class="verification-input">
                        <input type="text" maxlength="1" class="verification-input">
                        <input type="text" maxlength="1" class="verification-input">
                        <input type="text" maxlength="1" class="verification-input">
                    </div>
                    
                    <!-- Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ -->
                    <div class="text-center mb-6">
                        <p class="text-gray-600 mb-2">Ù„Ù… ÙŠØµÙ„Ùƒ Ø§Ù„Ø±Ù…Ø²ØŸ</p>
                        <button type="button" 
                                id="resendCode"
                                class="text-blue-600 hover:text-blue-800 font-medium disabled:opacity-50"
                                disabled>
                            Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø² (<span id="countdown" class="countdown-timer">60</span> Ø«Ø§Ù†ÙŠØ©)
                        </button>
                    </div>
                    
                    <!-- Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ -->
                    <div class="text-center">
                        <button type="button" id="verifyEmail" class="text-blue-600 hover:text-blue-800 font-medium">
                            <i class="fas fa-envelope ml-2"></i> Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
                        </button>
                    </div>
                </div>
                
                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ -->
                <div class="flex justify-between">
                    <button type="button" 
                            id="prevStep2"
                            class="border border-gray-300 text-gray-700 px-8 py-3 rounded-xl font-bold hover:bg-gray-50 transition">
                        <i class="fas fa-arrow-right mr-3"></i> Ø§Ù„Ø³Ø§Ø¨Ù‚
                    </button>
                    
                    <button type="button" 
                            id="nextStep2"
                            class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-xl font-bold hover:shadow-xl transition">
                        Ø§Ù„ØªØ­Ù‚Ù‚ <i class="fas fa-check ml-3"></i>
                    </button>
                </div>
            </div>
            
            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
            <div class="step-content hidden" id="step-3">
                <div class="text-center mb-8">
                    <div class="w-24 h-24 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-check text-white text-4xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! ğŸ‰</h3>
                    <p class="text-gray-600 mb-6">ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­</p>
                </div>
                
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ -->
                <div class="bg-gray-50 rounded-xl p-6 mb-8">
                    <h4 class="font-bold mb-4 text-gray-800">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø¨Ùƒ:</h4>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Ø§Ù„Ø§Ø³Ù…:</span>
                            <span id="accountName" class="font-bold"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</span>
                            <span id="accountEmail" class="font-bold"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨:</span>
                            <span id="accountType" class="font-bold"></span>
                        </div>
                    </div>
                </div>
                
                <!-- Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© -->
                <div class="space-y-4">
                    <a href="../dashboard.html" 
                       class="block bg-gradient-to-r from-blue-600 to-purple-600 text-white text-center p-4 rounded-xl font-bold hover:shadow-xl transition">
                        <i class="fas fa-tachometer-alt ml-2"></i> Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                    </a>
                    
                    <a href="../index.html" 
                       class="block border border-gray-300 text-gray-700 text-center p-4 rounded-xl font-bold hover:bg-gray-50 transition">
                        <i class="fas fa-home ml-2"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </a>
                    
                    <a href="login.html" 
                       class="block text-blue-600 hover:text-blue-800 text-center p-2 font-medium">
                        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨Ùƒ
                    </a>
                </div>
            </div>
        </form>
    </div>
    
    <!-- JavaScript -->
    <script src="../js/auth-validation.js"></script>
    <script src="../js/auth-utils.js"></script>
    <script src="../js/auth-main.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
            let currentStep = 1;
            const totalSteps = 3;
            let countdownTimer;
            let countdownSeconds = 60;
            
            // Ø§Ù„Ø¹Ù†Ø§ØµØ±
            const stepContents = document.querySelectorAll('.step-content');
            const stepIndicators = document.querySelectorAll('.step-indicator');
            const userTypeCards = document.querySelectorAll('.user-type-card');
            const userTypeInput = document.getElementById('userType');
            const phoneDisplay = document.getElementById('phoneDisplay');
            const accountName = document.getElementById('accountName');
            const accountEmail = document.getElementById('accountEmail');
            const accountType = document.getElementById('accountType');
            const verificationInputs = document.querySelectorAll('.verification-input');
            const resendCodeBtn = document.getElementById('resendCode');
            const countdownElement = document.getElementById('countdown');
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ­Ù‚Ù‚
            const validator = new AuthValidator();
            
            // Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            userTypeCards.forEach(card => {
                card.addEventListener('click', function() {
                    userTypeCards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    userTypeInput.value = this.dataset.type;
                });
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ÙƒØªØ§Ø¨Ø©
            const passwordInput = document.getElementById('registerPassword');
            passwordInput.addEventListener('input', function() {
                const requirements = AuthUtils.validatePasswordRequirements(this.value);
                
                // ØªØ­Ø¯ÙŠØ« Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª
                document.getElementById('reqLength').classList.toggle('valid', requirements.length);
                document.getElementById('reqLength').classList.toggle('invalid', !requirements.length);
                
                document.getElementById('reqUppercase').classList.toggle('valid', requirements.uppercase);
                document.getElementById('reqUppercase').classList.toggle('invalid', !requirements.uppercase);
                
                document.getElementById('reqLowercase').classList.toggle('valid', requirements.lowercase);
                document.getElementById('reqLowercase').classList.toggle('invalid', !requirements.lowercase);
                
                document.getElementById('reqNumber').classList.toggle('valid', requirements.number);
                document.getElementById('reqNumber').classList.toggle('invalid', !requirements.number);
                
                document.getElementById('reqSpecial').classList.toggle('valid', requirements.special);
                document.getElementById('reqSpecial').classList.toggle('invalid', !requirements.special);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
                const updateIcon = (elementId, isValid) => {
                    const element = document.getElementById(elementId);
                    const icon = element.querySelector('i');
                    icon.classList.toggle('fa-check-circle', isValid);
                    icon.classList.toggle('fa-circle', !isValid);
                    icon.classList.toggle('text-green-500', isValid);
                    icon.classList.toggle('text-gray-400', !isValid);
                };
                
                updateIcon('reqLength', requirements.length);
                updateIcon('reqUppercase', requirements.uppercase);
                updateIcon('reqLowercase', requirements.lowercase);
                updateIcon('reqNumber', requirements.number);
                updateIcon('reqSpecial', requirements.special);
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
            const confirmPasswordInput = document.getElementById('confirmPassword');
            confirmPasswordInput.addEventListener('input', function() {
                const password = passwordInput.value;
                const confirm = this.value;
                
                if (confirm && password !== confirm) {
                    this.classList.add('border-red-500');
                    document.getElementById('confirmPasswordError').textContent = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©';
                    document.getElementById('confirmPasswordError').classList.remove('hidden');
                } else {
                    this.classList.remove('border-red-500');
                    document.getElementById('confirmPasswordError').classList.add('hidden');
                }
            });
            
            // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·ÙˆØ§Øª
            document.getElementById('nextStep1').addEventListener('click', function() {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø®Ø·ÙˆØ© 1
                const form = document.getElementById('registerForm');
                const errors = validator.validateRegisterStep1(form);
                
                if (Object.keys(errors).length > 0) {
                    validator.displayErrors(errors);
                    return;
                }
                
                // Ø¹Ø±Ø¶ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„ØªØ­Ù‚Ù‚
                const phone = document.getElementById('phone').value;
                const countryCode = document.getElementById('countryCode').value;
                phoneDisplay.textContent = countryCode + ' ' + phone;
                
                // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø®Ø·ÙˆØ© 2
                goToStep(2);
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚
                sendVerificationCode();
            });
            
            document.getElementById('prevStep2').addEventListener('click', function() {
                goToStep(1);
            });
            
            document.getElementById('nextStep2').addEventListener('click', function() {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø±Ù…Ø²
                const code = Array.from(verificationInputs)
                    .map(input => input.value)
                    .join('');
                
                if (code.length !== 6) {
                    showErrorMessage('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…ÙƒÙˆÙ† Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù…');
                    return;
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù…Ø²
                verifyCode(code);
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
            document.getElementById('verifyEmail').addEventListener('click', function() {
                const email = document.getElementById('registerEmail').value;
                
                AuthAPI.sendEmailVerification(email)
                    .then(response => {
                        showSuccessMessage('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ');
                    })
                    .catch(error => {
                        showErrorMessage('ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù‚Ù‚: ' + error.message);
                    });
            });
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø²
            resendCodeBtn.addEventListener('click', function() {
                if (!this.disabled) {
                    sendVerificationCode();
                    startCountdown();
                }
            });
            
            // Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚
            verificationInputs.forEach((input, index) => {
                input.addEventListener('input', function() {
                    // Ø§Ù„ØªØ­Ø±Ùƒ Ù„Ù„Ø®Ø§Ù†Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                    if (this.value.length === 1 && index < verificationInputs.length - 1) {
                        verificationInputs[index + 1].focus();
                    }
                    
                    // ØªØ­Ø¯ÙŠØ« Ù†Ù…Ø· Ø§Ù„Ø®Ø§Ù†Ø©
                    this.classList.toggle('filled', this.value.length === 1);
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø±Ù…Ø²
                    const code = Array.from(verificationInputs)
                        .map(input => input.value)
                        .join('');
                    
                    if (code.length === 6) {
                        verifyCode(code);
                    }
                });
                
                // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù…ÙØªØ§Ø­ Backspace
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Backspace' && !this.value && index > 0) {
                        verificationInputs[index - 1].focus();
                    }
                });
            });
            
            // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
            function goToStep(step) {
                if (step < 1 || step > totalSteps) return;
                
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                stepContents.forEach(content => {
                    content.classList.remove('active');
                    content.classList.add('hidden');
                });
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø®Ø·ÙˆØ§Øª
                stepIndicators.forEach((indicator, index) => {
                    const circle = indicator.querySelector('div');
                    const text = indicator.querySelector('span');
                    
                    if (index + 1 === step) {
                        // Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ù†Ø´Ø·Ø©
                        circle.classList.remove('bg-gray-200', 'text-gray-600');
                        circle.classList.add('bg-green-500', 'text-white');
                        text.classList.remove('text-gray-500');
                        text.classList.add('text-green-600');
                    } else if (index + 1 < step) {
                        // Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©
                        circle.classList.remove('bg-gray-200', 'text-gray-600');
                        circle.classList.add('bg-green-500', 'text-white');
                        text.classList.remove('text-gray-500');
                        text.classList.add('text-green-600');
                    } else {
                        // Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©
                        circle.classList.remove('bg-green-500', 'text-white');
                        circle.classList.add('bg-gray-200', 'text-gray-600');
                        text.classList.remove('text-green-600');
                        text.classList.add('text-gray-500');
                    }
                });
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                const stepElement = document.getElementById(`step-${step}`);
                if (stepElement) {
                    stepElement.classList.remove('hidden');
                    stepElement.classList.add('active');
                }
                
                currentStep = step;
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø®Ø·ÙˆØ© 3ØŒ ØªØ¹Ø¨Ø¦Ø© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨
                if (step === 3) {
                    fillAccountInfo();
                }
            }
            
            function sendVerificationCode() {
                const phone = document.getElementById('phone').value;
                const countryCode = document.getElementById('countryCode').value;
                const fullPhone = countryCode + phone;
                
                AuthAPI.sendVerificationCode(fullPhone)
                    .then(response => {
                        showSuccessMessage('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ Ù‡Ø§ØªÙÙƒ');
                        startCountdown();
                    })
                    .catch(error => {
                        showErrorMessage('ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚: ' + error.message);
                    });
            }
            
            function startCountdown() {
                clearInterval(countdownTimer);
                countdownSeconds = 60;
                resendCodeBtn.disabled = true;
                
                countdownTimer = setInterval(() => {
                    countdownSeconds--;
                    countdownElement.textContent = countdownSeconds;
                    
                    if (countdownSeconds <= 0) {
                        clearInterval(countdownTimer);
                        resendCodeBtn.disabled = false;
                        countdownElement.textContent = 'Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„';
                    }
                }, 1000);
            }
            
            function verifyCode(code) {
                const phone = document.getElementById('phone').value;
                const countryCode = document.getElementById('countryCode').value;
                const fullPhone = countryCode + phone;
                
                AuthAPI.verifyCode(fullPhone, code)
                    .then(response => {
                        showSuccessMessage('ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ù†Ø¬Ø§Ø­!');
                        
                        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨
                        createAccount();
                    })
                    .catch(error => {
                        showErrorMessage('Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ ØºÙŠØ± ØµØ­ÙŠØ­');
                        
                        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„
                        verificationInputs.forEach(input => {
                            input.value = '';
                            input.classList.remove('filled');
                        });
                        verificationInputs[0].focus();
                    });
            }
            
            function createAccount() {
                const formData = {
                    fullName: document.getElementById('fullName').value,
                    email: document.getElementById('registerEmail').value,
                    phone: document.getElementById('countryCode').value + document.getElementById('phone').value,
                    city: document.getElementById('city').value,
                    userType: document.getElementById('userType').value,
                    password: document.getElementById('registerPassword').value
                };
                
                AuthAPI.register(formData)
                    .then(response => {
                        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø®Ø·ÙˆØ© 3
                        goToStep(3);
                    })
                    .catch(error => {
                        showErrorMessage('ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨: ' + error.message);
                    });
            }
            
            function fillAccountInfo() {
                accountName.textContent = document.getElementById('fullName').value;
                accountEmail.textContent = document.getElementById('registerEmail').value;
                
                const userType = document.getElementById('userType').value;
                const typeNames = {
                    'buyer': 'Ù…Ø´ØªØ±ÙŠ',
                    'seller': 'Ø¨Ø§Ø¦Ø¹',
                    'both': 'Ø¨Ø§Ø¦Ø¹ ÙˆÙ…Ø´ØªØ±ÙŠ'
                };
                accountType.textContent = typeNames[userType] || userType;
            }
            
            function showSuccessMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'fixed top-4 right-4 z-50 px-6 py-3 bg-green-500 text-white rounded-lg shadow-lg animate__animated animate__fadeInDown';
                messageDiv.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-check-circle mr-3"></i>
                        <span>${message}</span>
                    </div>
                `;
                document.body.appendChild(messageDiv);
                
                setTimeout(() => {
                    messageDiv.classList.add('animate__fadeOutUp');
                    setTimeout(() => messageDiv.remove(), 300);
                }, 3000);
            }
            
            function showErrorMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'fixed top-4 right-4 z-50 px-6 py-3 bg-red-500 text-white rounded-lg shadow-lg animate__animated animate__fadeInDown';
                messageDiv.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-exclamation-circle mr-3"></i>
                        <span>${message}</span>
                    </div>
                `;
                document.body.appendChild(messageDiv);
                
                setTimeout(() => {
                    messageDiv.classList.add('animate__fadeOutUp');
                    setTimeout(() => messageDiv.remove(), 300);
                }, 3000);
            }
            
            // Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            startCountdown();
        });
    </script>
</body>
</html>